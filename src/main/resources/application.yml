spring:
  application:
    name: videos-recommender

  datasource:
    url: jdbc:h2:mem:videosdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:

  h2:
    console:
      enabled: true
      path: /h2-console

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: true

  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

server:
  port: 8080
  max-http-request-header-size: 16KB
  tomcat:
    max-http-form-post-size: 128KB    # Limit request body size

spring.servlet.multipart:
  max-request-size: 100KB
  max-file-size: 100KB

# OpenAPI / Swagger configuration
springdoc:
  api-docs:
    enabled: true
    path: /api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
    display-request-duration: true
    try-it-out-enabled: true
  show-actuator: false

logging:
  level:
    root: INFO
    com.xay.videos_recommender: DEBUG

# Application configuration
app:
  feed:
    ttl-hint-seconds: 30
    timeout-ms: 600
  worker:
    event-aggregation:
      poll-interval-ms: 500    # For testing: pull events every 500ms
      batch-size: 50           # Max events per batch
  cache:
    tenant:
      max-size: 120
    user-profile:
      max-size: 100000
      expire-after-write-minutes: 60
    content-candidates:
      max-size: 120
    feed:
      max-size: 100000
      expire-after-write-minutes: 60
